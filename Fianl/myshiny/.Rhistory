ath<- read.csv("athlete_wewant.csv")
ath['num']=1
ath1<-ath%>%group_by(NOC,Year,Sex)%>%summarize(Medal_sum=sum(Medal_score),people=sum(num))
ath1<-ath1%>%filter(Year>=1990)
ath2<-spread(ath1,Sex,Medal_sum)
ath2["F_peo*medal"]<-ath2['people']*ath2["F"]
ath3=data.frame(ath2[,1:3],ath2[,5])
ath4=na.omit(ath3)
View(ath4)
ath5<-unite(ath4,Country.Code_year,NOC,Year,sep='_')
View(ath5)
ath6=data.frame(ath2[,1:3],ath2[,6])
View(ath6)
ath7=na.omit(ath6)
ath8<-unite(ath7,Country.Code_year,NOC,Year,sep='_')
View(ath8)
colnames(ath5)<-c('NOC',"Malepeople","Malemedalscore")
colnames(ath8)<-c('NOC',"Femalepeople","Femalemedalscore*people")
merge(ath5,ath8,by="NOC")
ath9=merge(ath5,ath8,by="NOC")
View(ath9)
View(gen4)
ath9["score"]=ath9[,5]/ath9[,2]
ath10=ath9["score"]
View(ath10)
ath10=data.frame(ath9[,1],ath9[,6])
ath10=data.frame(ath9["NOC"],ath9["score"])
colnames(gen4['Country.Code_year'])=c('NOC')
colnames(gen4)=c('NOC',"gen_ave")
datamerge=merge(ath10,gen4,by="NOC")
View(datamerge)
class(datamerge[200,2])
library(ggplot2)
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()
View(gender)
View(gen1)
gen1[264:526,2:28]<-(gen1[264:526,2:28]*(-1)+1000)/10
gen1[527:789,2:28]<-(gen1[527:789,2:28]*(-1)+10)/*10
gen1[527:789,2:28]<-(gen1[527:789,2:28]*(-1)+10)*10
colnames(gen1)<-c("Country.Code",as.character(c(1990:2016)))
gen2<-gather(gen1,year,gender_var,-Country.Code)
View(gen2)
View(gen2)
gen3<-unite(gen2,Country.Code_year,Country.Code,year,sep='_')
na.omit(gen3)
gen4<-na.omit(gen3)%>%
group_by(Country.Code_year)%>%
summarize(ave=mean(gender_var))
View(gen4)
View(gen4)
colnames(gen4)=c('NOC',"gen_ave")
datamerge=merge(ath10,gen4,by="NOC")
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()+geom_smooth()
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm')
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
datamerge2=merge(ath10,gen4,by="NOC")
str_replace(datamerge2,0,NA)
datamerge2[datamerge2==0]<-NA
View(datamerge2)
na.omit(datamerge2)
View(datamerge2)
ggplot(datamerge2,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
datamerge3<-na.omit(datamerge2)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
datamerge2=merge(ath10,gen4,by="NOC")
datamerge2[datamerge2==0]<-NA
datamerge3<-na.omit(datamerge2)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
View(datamerge3)
View(datamerge2)
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(,se=F)
method='lm'
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
View(datamerge3)
setwd("C:/Users/hank7/Desktop/summer/NTU-R/Fianl")
library(stringr)
gender <-read.csv("Gender_wewant1.csv")
any(is.na(gender))
#summary(gender)
library(dplyr)
library(tidyr)
library(ggplot2)
colnames(gender)<-c("Country.Code","Country.Name","Series.Name",as.character(c(1990:2016)))
gen1<-cbind(gender[,1],gender[,4:30])
gen1[264:526,2:28]<-(gen1[264:526,2:28]*(-1)+1000)/10
gen1[527:789,2:28]<-(gen1[527:789,2:28]*(-1)+10)*10
colnames(gen1)<-c("Country.Code",as.character(c(1990:2016)))
gen2<-gather(gen1,year,gender_var,-Country.Code)
gen3<-unite(gen2,Country.Code_year,Country.Code,year,sep='_')
na.omit(gen3)
gen4<-na.omit(gen3)%>%
group_by(Country.Code_year)%>%
summarize(ave=mean(gender_var))
ath<- read.csv("athlete_wewant.csv")
ath['num']=1
ath1<-ath%>%group_by(NOC,Year,Sex)%>%summarize(Medal_sum=sum(Medal_score),people=sum(num))
ath1<-ath1%>%filter(Year>=1990)
ath2<-spread(ath1,Sex,Medal_sum)
ath2["F_peo*medal"]<-ath2['people']*ath2["F"]
ath3=data.frame(ath2[,1:3],ath2[,5])
ath4=na.omit(ath3)
ath5<-unite(ath4,Country.Code_year,NOC,Year,sep='_')
colnames(ath5)<-c('NOC',"Malepeople","Malemedalscore")
ath6=data.frame(ath2[,1:3],ath2[,6])
ath7=na.omit(ath6)
ath8<-unite(ath7,Country.Code_year,NOC,Year,sep='_')
colnames(ath8)<-c('NOC',"Femalepeople","Femalemedalscore*people")
ath9=merge(ath5,ath8,by="NOC")
ath9["score"]=ath9[,5]/ath9[,2]
ath10=data.frame(ath9["NOC"],ath9["score"])
colnames(gen4)=c('NOC',"gen_ave")
datamerge2=merge(ath10,gen4,by="NOC")
datamerge2[datamerge2==0]<-NA
datamerge3<-na.omit(datamerge2)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
View(datamerge3)
View(ath9)
View(gen2)
View(gen1)
View(gen3)
View(gender)
View(gen1)
genA <-gen1[1:263,]
genB <-gen1[264:526,]
genC <-gen1[527:789,]
genD <-gen1[790:1052,]
genE <-gen1[1053:1315,]
genF <-gen1[1316:1578,]
genG <-gen1[1579:1841,]
genH <-gen1[1842:2104,]
ggplot(datamerge3,aes(y=gen_ave,x=score))+geom_point()+geom_smooth(method='lm',se=F)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)+scale_y_log10()
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth()+scale_y_log10()
View(gender)
View(genA)
genA1 <-gather(genA,year,'Adjusted net enrollment rate, primary, female (% of primary school age children)',-Country.Code)
View(genA1)
genB1 <-gather(genB,year,'Adolescent fertility rate (Adjusted)',-Country.Code)
genC1 <-gather(genC,year,'Fertility rate, total (Adjusted)',-Country.Code)
genD1 <-gather(genD,year,'Labor force, female (% of total labor force)',-Country.Code)
genE1 <-gather(genE,year,'Literacy rate, adult female (% of females ages 15 and above)',-Country.Code)
genF1 <-gather(genF,year,'Life expectancy at birth, female (years)',-Country.Code)
genG1 <-gather(genG,year,'Expected years of schooling, female',-Country.Code)
genH1 <-gather(genH,year,'Primary education, pupils (% female)',-Country.Code)
View(genE1)
View(genG1)
View(genC1)
genA2<-unite(genA1,NOC,Country.Code,year,sep='_')
View(genA2)
genB2<-unite(genB1,NOC,Country.Code,year,sep='_')
genC2<-unite(genC1,NOC,Country.Code,year,sep='_')
genD2<-unite(genD1,NOC,Country.Code,year,sep='_')
genE2<-unite(genE1,NOC,Country.Code,year,sep='_')
genF2<-unite(genF1,NOC,Country.Code,year,sep='_')
genG2<-unite(genG1,NOC,Country.Code,year,sep='_')
genH2<-unite(genH1,NOC,Country.Code,year,sep='_')
View(datamerge2)
View(gen4)
View(datamerge2)
View(datamerge3)
dm<-merge(datamerge3,genA2,genB2,genC2,genD2,genE2,genF2,genG2,genH2,by="NOC")
View(datamerge3)
View(genA2)
dm<-merge(datamerge3,genA2,by="NOC")
View(dm)
dm1<-merge(dm,genB2,by="NOC")
dm2<-merge(dm1,genC2,by="NOC")
dm3<-merge(dm2,genD2,by="NOC")
dm4<-merge(dm3,genE2,by="NOC")
dm5<-merge(dm4,genF2,by="NOC")
dm6<-merge(dm5,genG2,by="NOC")
dm7<-merge(dm6,genH2,by="NOC")
View(dm7)
ggplot(dm7,aes(x='Life expectancy at birth, female (years)',y=score))+geom_point()
class(dm7[10,5])
ggplot(dm7,aes(x=`Adjusted net enrollment rate, primary, female (% of primary school age children)`,y=score))+geom_point()
ggplot(dm7,aes(x=`Literacy rate, adult female (% of females ages 15 and above)`,y=score))+geom_point()
ggplot(dm7,aes(x=`Adjusted net enrollment rate, primary, female (% of primary school age children)`,y=score))+geom_point()
ggplot(dm7,aes(x=`Adolescent fertility rate (Adjusted)`,y=score))+geom_point()
ggplot(dm7,aes(x=`Fertility rate, total (Adjusted)`,y=score))+geom_point()
ggplot(dm7,aes(x=`Labor force, female (% of total labor force)`,y=score))+geom_point()
ggplot(dm7,aes(x=`Expected years of schooling, female`,y=score))+geom_point()
ggplot(dm7,aes(x=`Primary education, pupils (% female)`,y=score))+geom_point()
ggplot(dm7,aes(x=`Primary education, pupils (% female)`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm7,aes(x=`Adjusted net enrollment rate, primary, female (% of primary school age children)`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm7,aes(x=`Adjusted net enrollment rate, primary, female (% of primary school age children)`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm7,aes(x=`Adolescent fertility rate (Adjusted)`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm7,aes(x=`Fertility rate, total (Adjusted)`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm7,aes(x=`Labor force, female (% of total labor force)`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm7,aes(x=`Literacy rate, adult female (% of females ages 15 and above)`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm7,aes(x=`Life expectancy at birth, female (years)`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm7,aes(x=`Expected years of schooling, female`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm7,aes(x=`Primary education, pupils (% female)`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
View(dm7)
View(dm7)
summary(dm7)
library(stringr)
gender <-read.csv("Gender_wewant1.csv")
View(gender)
any(is.na(gender))
#summary(gender)
library(dplyr)
library(tidyr)
library(ggplot2)
colnames(gender)<-c("Country.Code","Country.Name","Series.Name",as.character(c(1992:2016)))
gen1<-cbind(gender[,1],gender[,4:28])
setwd("C:/Users/hank7/Desktop/summer/NTU-R/Fianl")
setwd("C:/Users/hank7/Desktop/summer/NTU-R/Fianl")
library(stringr)
gender <-read.csv("Gender_wewant1.csv")
any(is.na(gender))
#summary(gender)
library(dplyr)
library(tidyr)
library(ggplot2)
colnames(gender)<-c("Country.Code","Country.Name","Series.Name",as.character(c(1992:2016)))
gen1<-cbind(gender[,1],gender[,4:28])
gen1[264:526,2:28]<-(gen1[264:526,2:28]*(-1)+1000)/10
View(gen1)
gen1[264:526,2:26]<-(gen1[264:526,2:26]*(-1)+1000)/10
gen1[527:789,2:26]<-(gen1[527:789,2:26]*(-1)+10)*10
colnames(gen1)<-c("Country.Code",as.character(c(1990:2016)))
colnames(gen1)<-c("Country.Code",as.character(c(1992:2016)))
gen2<-gather(gen1,year,gender_var,-Country.Code)
View(gen2)
gen3<-unite(gen2,Country.Code_year,Country.Code,year,sep='_')
summary(gender)
summary(dm7)
library(stringr)
gender <-read.csv("Gender_wewant1.csv")
View(gender)
any(is.na(gender))
#summary(gender)
library(dplyr)
library(tidyr)
library(ggplot2)
colnames(gender)<-c("Country.Code","Country.Name","Series.Name",as.character(c(1992:2016)))
gen1<-cbind(gender[,1],gender[,4:28])
View(gen1)
View(gen2)
View(gender)
gen1[264:526,2:26]<-(gen1[264:526,2:26]*(-1)+1000)/10
View(gen1)
View(gen1)
colnames(gen1)<-c("Country.Code",as.character(c(1992:2016)))
View(gen1)
gen2<-gather(gen1,year,gender_var,-Country.Code)
View(gen2)
gen3<-unite(gen2,Country.Code_year,Country.Code,year,sep='_')
View(gen3)
gen4<-na.omit(gen3)%>%
group_by(Country.Code_year)%>%
summarize(ave=mean(gender_var))
View(gen4)
ath<- read.csv("athlete_wewant.csv")
ath['num']=1
View(ath)
ath1<-ath%>%filter(Year>=1990)%>%group_by(NOC,Year,Sex)%>%summarize(Medal_sum=sum(Medal_score),people=sum(num))
View(ath1)
View(ath1)
View(gender)
View(gen1)
#gen1[264:526,2:26]<-(gen1[264:526,2:26]*(-1)+1000)/10
gen1[1316:1578,2:26]<-gen1[1316:1578,2:26]*5
colnames(gen1)<-c("Country.Code",as.character(c(1992:2016)))
gen2<-gather(gen1,year,gender_var,-Country.Code)
gen3<-unite(gen2,Country.Code_year,Country.Code,year,sep='_')
gen4<-na.omit(gen3)%>%
group_by(Country.Code_year)%>%
summarize(ave=mean(gender_var))
View(gen4)
View(ath)
View(ath1)
ath1A<-ath%>%filter(Year>=1990)%>%group_by(NOC,Year)%>%summarize(join_people=sum(num))
View(ath1A)
View(ath1A)
ath1B<-unite(ath1A,NOC,NOC,Year,sep='_')
View(ath1B)
View(ath)
ath2A<-ath1%>%filter(Sex=="F")
View(ath2A)
View(ath1B)
ath2B<-unite(ath2A,NOC,NOC,Year,sep='_')
View(ath2B)
ath2C<-data.frame(ath2B[,1],ath2B[,3])
View(ath2C)
ath3<-merge(ath2C,ath1B,by="NOC")
View(ath3)
ath3["Fscore"]=ath[,2]/ath[,3]
ath3["Fscore"]=ath3[,2]/ath3[,3]
View(gen4)
colnames(gen4)=c('NOC',"gen_ave")
View(ath3)
datamerge2=merge(ath3,gen4,by="NOC",all=T)
View(datamerge2)
View(datamerge2)
datamerge3<-na.omit(datamerge2)
View(datamerge3)
View(datamerge3)
ggplot(datamerge3,aes(x=gen_ave,y=Fscore))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(datamerge3,aes(x=gen_ave,y=Fscore))+geom_point()+geom_smooth()
View(datamerge3)
datamerge4<-datamerge3%>%filter(gen_ave<=70)
ggplot(datamerge4,aes(x=gen_ave,y=Fscore))+geom_point()+geom_smooth()
ggplot(datamerge4,aes(x=gen_ave,y=Fscore))+geom_point()+geom_smooth(method="lm")
ggplot(datamerge4,aes(x=gen_ave,y=Fscore))+geom_point()+geom_smooth(method="lm")+scale_y_log10()
View(gender)
genA <-gen1[1:263,]
genB <-gen1[264:526,]
genC <-gen1[527:789,]
genD <-gen1[790:1052,]
genE <-gen1[1053:1315,]
genF <-gen1[1316:1578,]
genA1 <-gather(genA,year,'Adjusted net enrollment rate, primary, female (% of primary school age children)',-Country.Code)
genB1 <-gather(genB,year,'Adolescent fertility rate (Adjusted)',-Country.Code)
genC1 <-gather(genC,year,'Labor force, female (% of total labor force)',-Country.Code)
genD1 <-gather(genD,year,'Expected years of schooling, female',-Country.Code)
genE1 <-gather(genE,year,'Primary education, pupils (% female)',-Country.Code)
genF1 <-gather(genF,year,'Employers, female (% of female employment) (modeled ILO estimate)',-Country.Code)
View(genF1)
genA2<-unite(genA1,NOC,Country.Code,year,sep='_')
genB2<-unite(genB1,NOC,Country.Code,year,sep='_')
genC2<-unite(genC1,NOC,Country.Code,year,sep='_')
genD2<-unite(genD1,NOC,Country.Code,year,sep='_')
genE2<-unite(genE1,NOC,Country.Code,year,sep='_')
genF2<-unite(genF1,NOC,Country.Code,year,sep='_')
dm<-merge(datamerge4,genA2,by="NOC")
dm1<-merge(dm,genB2,by="NOC")
dm2<-merge(dm1,genC2,by="NOC")
dm3<-merge(dm2,genD2,by="NOC")
dm4<-merge(dm3,genE2,by="NOC")
dm5<-merge(dm4,genF2,by="NOC")
View(dm5)
ggplot(dm5,aes(x=`Adjusted net enrollment rate, primary, female (% of primary school age children)`,y=score))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm5,aes(x=`Adjusted net enrollment rate, primary, female (% of primary school age children)`,y=Fscore))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm5,aes(x=`Adolescent fertility rate (Adjusted)`,y=Fscore))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(dm5,aes(x=`Labor force, female (% of total labor force)`,y=Fscore))+geom_point()+geom_smooth()+scale_y_log10()
ggplot(datamerge4,aes(x=gen_ave,y=Fscore))+geom_point()+geom_smooth(method="lm")+scale_y_log10()
datamerge4<-datamerge3%>%filter(gen_ave<=65)
ggplot(datamerge4,aes(x=gen_ave,y=Fscore))+geom_point()+geom_smooth(method="lm")+scale_y_log10()
dm<-merge(datamerge4,genA2,by="NOC")
dm1<-merge(dm,genB2,by="NOC")
dm2<-merge(dm1,genC2,by="NOC")
dm3<-merge(dm2,genD2,by="NOC")
dm4<-merge(dm3,genE2,by="NOC")
dm5<-merge(dm4,genF2,by="NOC")
ggplot(dm5,aes(x=`Adjusted net enrollment rate, primary, female (% of primary school age children)`,y=Fscore))+geom_point()+geom_smooth(method="lm")+scale_y_log10()
ggplot(dm5,aes(x=`Adolescent fertility rate (Adjusted)`,y=Fscore))+geom_point()+geom_smooth(method="lm")+scale_y_log10()
ggplot(dm5,aes(x=`Labor force, female (% of total labor force)`,y=Fscore))+geom_point()+geom_smooth(method="lm")+scale_y_log10()
ggplot(dm5,aes(x=`Expected years of schooling, female`,y=Fscore))+geom_point()+geom_smooth(method="lm")+scale_y_log10()
ggplot(dm5,aes(x=`Primary education, pupils (% female)`,y=Fscore))+geom_point()+geom_smooth(method="lm")+scale_y_log10()
ggplot(dm5,aes(x=`Employers, female (% of female employment) (modeled ILO estimate)`,y=Fscore))+geom_point()+geom_smooth(method="lm")+scale_y_log10()
summary(dm5)
ggplot(dm5,aes(x=`Employers, female (% of female employment) (modeled ILO estimate)`,y=Fscore))+geom_point()+geom_smooth(method="lm")+scale_y_log10()+scale_x_log10()
View(dm5)
View(dm5)
library(Hmisc)
colnames(dm5)<-c("NOC","Medal_sum","join_people","Female_score","enrollment","Adolescent_fertility","Labor","schooling_year","Primary_edu","Employer")
library(Hmisc)
dm5$enrollment
dm5$enrollment_ro<-round(dm5$enrollment_ro,digits=-1)
dm5$enrollment_ro<-round(dm5$enrollment,digits=-1)
dm5$enrollment_ro<-round(dm5$enrollment,digits=-1)
dm5$Adolescent_fertility_ro<-round(dm5$Adolescent_fertility,digits=-1)
dm5$Labor_ro<-round(dm5$Labor,digits=-1)
dm5$schooling_year_ro<-round(dm5$schooling_year,digits=-1)
dm5$Primary_edu_ro<-round(dm5$Primary_edu,digits=-1)
dm5$Employer_ro<-round(dm5$Employer,digits=-1)
View(dm4)
dm5<-merge(dm4,genF2,by="NOC")
View(dm5)
colnames(dm5)<-c("NOC","Medal_sum","join_people","Female_score","enrollment","Adolescent_fertility","Labor","schooling_year","Primary_edu","Employer")
dm5<-merge(dm4,genF2,by="NOC")
View(dm5)
colnames(dm5)<-c("NOC","Medal_sum","join_people","Female_score","gen_ave","enrollment","Adolescent_fertility","Labor","schooling_year","Primary_edu","Employer")
dm5$enrollment_ro<-round(dm5$enrollment,digits=-1)
dm5$Adolescent_fertility_ro<-round(dm5$Adolescent_fertility,digits=-1)
dm5$Labor_ro<-round(dm5$Labor,digits=-1)
dm5$schooling_year_ro<-round(dm5$schooling_year,digits=-1)
dm5$Primary_edu_ro<-round(dm5$Primary_edu,digits=-1)
dm5$Employer_ro<-round(dm5$Employer,digits=-1)
View(dm5)
summary(dm5)
View(ath3)
c(20:100,by=10)
dm5$enrollment_ro<-factor(dm5$enrollment_ro,levels=c(20,30,40,50,60,70,80,90,100))
dm5$enrollment_ro<-factor(dm5$enrollment_ro,levels=c(20,30,40,50,60,70,80,90,100))
dm5$Adolescent_fertility_ro<-factor(dm5$Adolescent_fertility_ro,levels=c(80,90,100))
dm5$Labor_ro<-factor(dm5$Labor_ro,levels=c(10,20,30,40,50,60))
dm5$schooling_year_ro<-factor(dm5$schooling_year_ro,levels=c(0,10,20))
dm5$Primary_edu_ro<-factor(dm5$Primary_edu_ro,levels=c(30,40,50))
dm5$Employer_ro<-factor(dm5$Employer_ro,levels=c(0,10,20,30,40,50,60,70,80,90,100,110))
ggplot(data = dm5,
aes(x = enrollment_ro, y = Female_score))+geom_boxplot() +
scale_y_log10()
ggplot(data = dm5,
aes(x = enrollment_ro, y = Female_score))+geom_boxplot() +
scale_y_log10() +
coord_flip()
anova(m1 <- lm(Female_score ~ enrollment_ro, data = dm5))
anova(m1 <- lm(Female_score ~ enrollment, data = dm5))
dm5<-merge(dm4,genF2,by="NOC")
colnames(dm5)<-c("NOC","Medal_sum","join_people","Female_score","gen_ave","enrollment","Adolescent_fertility","Labor","schooling_year","Primary_edu","Employer")
View(dm5)
library(Hmisc)
summary(dm5)
ggplot(data = dm5,
aes(x = enrollment_ro, y = Female_score))+geom_boxplot() +
scale_y_log10() +
coord_flip()
ggplot(data = dm5,
aes(x = enrollment, y = Female_score))+geom_boxplot() +
scale_y_log10() +
coord_flip()
anova(m1 <- lm(Female_score ~ enrollment, data = dm5))
View(dm5)
regtree <- rpart(dm5$Female_score, data=dm5[,6:11])
library(rpart)
install.packages("survival")
library(DMwR)
install.packages("DMwR")
regtree <- rpart(dm5$Female_score, data=dm5[,6:11])
regtree <- rpart(dm5$Female_score~., data=dm5[,6:11])
prettyTree(regtree)
library(rpart)
library(DMwR)
library(grid)
prettyTree(regtree)
regtree <- rpart(dm5$Female_score~., data=dm5[,6:8])
prettyTree(regtree)
regtree <- rpart(dm5$Female_score~., data=dm5[,6:7])
prettyTree(regtree)
regtree <- rpart(dm5$Female_score~., data=dm5[,6:11])
prettyTree(regtree)
m6 <- lm(Female_score~+enrollment+Adolescent_fertility+Labor+schooling_year+Primary_edu+Employer,data=dm5)
anova(m6)
library(randomForest)
install.packages("randomForest")
library(randomForest)
set.seed(8000)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf.predictions <- predict(rf2,dm5)
nmse.rf <- mean((rf.predictions-dm5[,"Female_score"])^2)/mean(
(mean(dm5$Female_score)-dm5[,"Female_score"])^2)
print(nmse.rf) #0.2
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
dm5[,8]
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~,data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~.,data=dm5[,8], ntree=500, importance=T)
set.seed(8000)
rf2 <- randomForest(dm5$Female_score~.,data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf.predictions <- predict(rf2,dm5)
nmse.rf <- mean((rf.predictions-dm5[,"Female_score"])^2)/mean(
(mean(dm5$Female_score)-dm5[,"Female_score"])^2)
print(nmse.rf) #0.2
rf2 <- randomForest(dm5$Female_score, data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score, data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~.,  ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~.,dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8])
dm5$Female_score~.
dm5$Female_score
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
install.packages("gridExtra")
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8:9], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8:11], ntree=500, importance=T)
set.seed(5000)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8:11], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,"Labor"], ntree=500, importance=T)
set.seed(8000)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,"Labor"], ntree=500, importance=T)
data=dm5[,"Labor"]
rf2 <- randomForest(dm5$Female_score~., data=dm5[,"Labor"], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5$Labor, ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
dm5%>%filter(NOC=='AFG_2004')
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Labor~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., 'data'=dm5[,8], ntree=500, importance=T)
View(gender)
rf2 <- randomForest(dm5$Female_score~, data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score, data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
coefplot( lm(Female_score~+enrollment+Adolescent_fertility+Labor+schooling_year+Primary_edu+Employer,data=dm5))
library(coefplot)
coefplot( lm(Female_score~+enrollment+Adolescent_fertility+Labor+schooling_year+Primary_edu+Employer,data=dm5))
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~, data=dm5[,8], ntree=500, importance=T)
regtree <- rpart(dm5$Female_score~., data=dm5[,8])
prettyTree(regtree)
regtree <- rpart(dm5$Female_score~., data=dm5[,8])
regtree <- rpart(dm5$Female_score~., data=dm5[,8:9])
prettyTree(regtree)
regtree <- rpart(dm5$Female_score~., data=dm5[,8:10])
prettyTree(regtree)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8:10], ntree=500, importance=T)
rf.predictions <- predict(rf2,dm5)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8:10], ntree=500, importance=T)
rf2 <- randomForest(dm5$Female_score~., data=dm5[,8:10], ntree=500, importance=T)
