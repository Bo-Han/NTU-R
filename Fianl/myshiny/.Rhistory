shiny::runApp()
runApp()
runApp()
runApp()
setwd("C:/Users/hank7/Desktop/summer/NTU-R/Fianl")
gender <-read.csv("Gender_wewant")
gender <-read.csv("Gender_wewant.csv")
View(gender)
is.na(gender)
any(is.na(gender))
str.replace(gender,"..",NA)
library(stringr)
str.replace(gender,"..",NA)
str_replace(gender,"..",NA)
str_replace(gender,"..","NA")
View(gender)
class(gender$X1990..YR1990.)
gender$X1990..YR1990.
gender<-as.numeric(gender)
gender<-as.numeric(gender[,])
gender<-as.character(gender[,])
gender<-as.data.frame(gender)
library(stringr)
gender <-read.csv("Gender_wewant.csv")
gender=apply(gender[1:2893,1:31], 2, as.character)
gender=data.frame(gender)
class(gender$X1992..YR1992.)
gender=apply(gender[1:2893,1:31], 1, as.character)
gender=data.frame(gender)
gender=apply(gender[1:2893,1:31], 2, as.character)
gender=data.frame(gender)
class(gender)
class(gender$X27)
gender <-read.csv("Gender_wewant.csv")
any(is.na(gender))
gender=apply(gender[1:2893,1:31], 2, as.character)
gender=data.frame(gender)
str_replace(gender,"..","NA")
gender <-read.csv("Gender_wewant.csv")
any(is.na(gender))
summary(gender)
class(gender[3,4])
c(1990:2017)
as.character(c(1990:2017))
c("Country.Code","Country.Name","Series.Name")+as.character(c(1990:2017))
c("Country.Code","Country.Name","Series.Name",as.character(c(1990:2017)))
colnames(gender)<-c("Country.Code","Country.Name","Series.Name",as.character(c(1990:2017)))
library(stringr)
gender <-read.csv("Gender_wewant1.csv")
any(is.na(gender))
colnames(gender)<-c("Country.Code","Country.Name","Series.Name",as.character(c(1990:2017)))
gather(gender,year,gender_var,-CountryCode)
#summary(gender)
library(dplyr)
gather(gender,year,gender_var,-CountryCode)
?gather
gather(gender,year,gender_var,-CountryCode)
install.packages("tidyr")
library(tidyr)
gather(gender,year,gender_var,-CountryCode)
gather(gender,year,gender_var,-Country.Code)
gen1<-gather(gender,year,gender_var,-Country.Code)
View(gen1)
gen1<-gather(gender,year,gender_var,-Series.Name)
gen1<-gather(gender,year,gender_var,-Country.Name)
cbind(gender[,1],gender[,4:31])
gen1<-cbind(gender[,1],gender[,4:31])
gen2<-gather(gen1,year,gender_var,-Country.Code)
gen2<-gather(gen1,year,gender_var,-gender[,1])
colnames(gen1[,1])<-c("Country.Code")
gen1[,1]
colnames(gen1)<-c("Country.Code",as.character(c(1990:2017)))
library(stringr)
gen2<-gather(gen1,year,gender_var,-Country.Code)
View(gen2)
gen3<-unite(gen2,Country.Code_year,Country.Code,year,sep='_')
View(gen3)
gen3%>%
group_by('Country.Code_year')%>%
summarize(ave=mean(gender_var))
gen4<-gen3%>%
group_by('Country.Code_year')%>%
summarize(ave=mean(gender_var))
View(gen4)
na.omit(gen3)
gen4<-na.omit(gen3)%>%
group_by('Country.Code_year')%>%
summarize(ave=mean(gender_var))
View(gen4)
gen4<-na.omit(gen3)%>%
group_by(Country.Code_year)%>%
summarize(ave=mean(gender_var))
gender <-read.csv("Gender_wewant1.csv")
colnames(gender)<-c("Country.Code","Country.Name","Series.Name",namev)
View(gen1)
gender <-read.csv("Gender_wewant1.csv")
any(is.na(gender))
namev=c("1990","1992","1992","1994","1994","1996","1996","1998","1998","2000","2000","2002","2002",
"2004","2004","2006","2006","2008","2008","2010","2010","2012","2012","2014","2014","2016","2016")
colnames(gender)<-c("Country.Code","Country.Name","Series.Name",namev)
gen1<-cbind(gender[,1],gender[,4:30])
colnames(gen1)<-c("Country.Code",as.character(c(1990:2017)))
colnames(gen1)<-c("Country.Code",namev)
gen2<-gather(gen1,year,gender_var,-Country.Code)
View(gen2)
gen2<-gather(gen1,year,gender_var)
library(stringr)
gender <-read.csv("Gender_wewant1.csv")
any(is.na(gender))
#summary(gender)
library(dplyr)
library(tidyr)
colnames(gender)<-c("Country.Code","Country.Name","Series.Name",as.character(c(1990:2016)))
gen1<-cbind(gender[,1],gender[,4:30])
colnames(gen1)<-c("Country.Code",as.character(c(1990:2016)))
gen2<-gather(gen1,year,gender_var,-Country.Code)
gen3<-unite(gen2,Country.Code_year,Country.Code,year,sep='_')
na.omit(gen3)
gen4<-na.omit(gen3)%>%
group_by(Country.Code_year)%>%
summarize(ave=mean(gender_var))
ath<- read.csv("athlete_wewant.csv")
View(ath)
ath['num']=1
ath<- read.csv("athlete_wewant.csv")
ath['num']=1
ath1<-ath%>%group_by(NOC,Year,Sex)%>%summarize(Medal_sum=sum(Medal_score),people=sum(num))
View(ath1)
ath1<-ath1%>%filter(Year>=1990)
ath2<-spread(ath1,sex,i)
ath2<-spread(ath1,Sex,i)
ath2<-spread(ath1,Sex,Medal_sum)
View(ath2)
View(ath2)
ath2['people']*ath2["F"]
ath2["F_peo*medal"]<-ath2['people']*ath2["F"]
cbind(ath2[,1:3],ath2[,5])
ath3=cbind(ath2[,1:3],ath2[,5])
ath2[,1:3]
View(ath3)
ath2[,5]
ath3=cbind(ath2[,1:3],ath2[,5])
ath3=data.frame(ath2[,1:3],ath2[,5])
View(ath3)
ath3=na.omit(ath3)
View(gen4)
ath4=na.omit(ath3)
View(gen4)
ath<- read.csv("athlete_wewant.csv")
ath['num']=1
ath1<-ath%>%group_by(NOC,Year,Sex)%>%summarize(Medal_sum=sum(Medal_score),people=sum(num))
ath1<-ath1%>%filter(Year>=1990)
ath2<-spread(ath1,Sex,Medal_sum)
ath2["F_peo*medal"]<-ath2['people']*ath2["F"]
ath3=data.frame(ath2[,1:3],ath2[,5])
ath4=na.omit(ath3)
View(ath4)
ath5<-unite(ath4,Country.Code_year,NOC,Year,sep='_')
View(ath5)
ath6=data.frame(ath2[,1:3],ath2[,6])
View(ath6)
ath7=na.omit(ath6)
ath8<-unite(ath7,Country.Code_year,NOC,Year,sep='_')
View(ath8)
colnames(ath5)<-c('NOC',"Malepeople","Malemedalscore")
colnames(ath8)<-c('NOC',"Femalepeople","Femalemedalscore*people")
merge(ath5,ath8,by="NOC")
ath9=merge(ath5,ath8,by="NOC")
View(ath9)
View(gen4)
ath9["score"]=ath9[,5]/ath9[,2]
ath10=ath9["score"]
View(ath10)
ath10=data.frame(ath9[,1],ath9[,6])
ath10=data.frame(ath9["NOC"],ath9["score"])
colnames(gen4['Country.Code_year'])=c('NOC')
colnames(gen4)=c('NOC',"gen_ave")
datamerge=merge(ath10,gen4,by="NOC")
View(datamerge)
class(datamerge[200,2])
library(ggplot2)
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()
View(gender)
View(gen1)
gen1[264:526,2:28]<-(gen1[264:526,2:28]*(-1)+1000)/10
gen1[527:789,2:28]<-(gen1[527:789,2:28]*(-1)+10)/*10
gen1[527:789,2:28]<-(gen1[527:789,2:28]*(-1)+10)*10
colnames(gen1)<-c("Country.Code",as.character(c(1990:2016)))
gen2<-gather(gen1,year,gender_var,-Country.Code)
View(gen2)
View(gen2)
gen3<-unite(gen2,Country.Code_year,Country.Code,year,sep='_')
na.omit(gen3)
gen4<-na.omit(gen3)%>%
group_by(Country.Code_year)%>%
summarize(ave=mean(gender_var))
View(gen4)
View(gen4)
colnames(gen4)=c('NOC',"gen_ave")
datamerge=merge(ath10,gen4,by="NOC")
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()+geom_smooth()
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm')
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
datamerge2=merge(ath10,gen4,by="NOC")
str_replace(datamerge2,0,NA)
datamerge2[datamerge2==0]<-NA
View(datamerge2)
na.omit(datamerge2)
View(datamerge2)
ggplot(datamerge2,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
datamerge3<-na.omit(datamerge2)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
datamerge2=merge(ath10,gen4,by="NOC")
datamerge2[datamerge2==0]<-NA
datamerge3<-na.omit(datamerge2)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
View(datamerge3)
View(datamerge2)
ggplot(datamerge,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(,se=F)
method='lm'
ggplot(datamerge3,aes(x=gen_ave,y=score))+geom_point()+geom_smooth(method='lm',se=F)
View(datamerge3)
